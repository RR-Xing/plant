if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((i=>t.resolve(e()).then((()=>i))),(i=>t.resolve(e()).then((()=>{throw i}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...i){uni.__log__?uni.__log__(e,t,...i):console[e].apply(console,[...i,t])}__definePage("pages/index/index",((e,t)=>{const i=e.__vccOpts||e;for(const[n,a]of t)i[n]=a;return i})({data:()=>({shiDu:"正在获取",time:"正在获取",shuiCao:"正在获取",yanWu:"正在获取",fengShan:"正在获取",content:"",shiDuOK:"hao",shuiCaoOK:"hao",yanWuOK:"hao",fengShanOK:"hao",sdtz:!1,sctz:!1,ywtz:!1,cid:""}),onShow(){this.huoQu(),this.timer=setInterval((()=>this.huoQu()),6e4)},onUnload(){clearInterval(this.timer)},methods:{huoQu(){uni.showLoading({title:"正在获取最新数值……"}),uni.request({url:"https://iot_s1.dfrobot.com.cn/apiv2/messages?topic=9QOBcXG4g&order=desc&field=created&pnum=1&psize=1000&begin=&end=&token=d5cb32edc0f0b3d9915f03cf1d7ea97a&iname=wBE94qNnR&ipwd=wfE9VqHngz",method:"GET",dataType:"json",timeout:3e4,success:e=>{uni.showToast({title:"更新成功！"}),t("log","at pages/index/index.vue:76",e);let i=e.data.data.docs[0],n=i.message.split("#");this.shiDu=n[1]+"%",n[1]<10?(this.shiDuOK="buHao",this.sdtz||(this.sdtz=!0,this.push("土壤湿度不足！","水泵正在努力……"))):(this.shiDuOK="hao",this.sdtz=!1),this.shuiCao=n[2],"没水了"===n[2]?(this.shuiCaoOK="buHao",this.sctz||(this.push("水槽水量不足！","请及时补水！"),this.sctz=!0)):(this.shiDuOK="hao",this.sctz=!1),this.yanWu=Math.floor(n[3]/1023*100)+"%",n[3]>75?(this.yanWuOK="buHao",this.ywtz||(this.push("烟雾浓度过高！","小风扇正在努力……"),this.ywtz=!0)):(this.yanWuOK="hao",this.ywtz=!1),this.fengShan=n[4],"on"===n[4]?this.fengShanOK="kai":this.fengShanOK="hao",this.time=i.created},fail:e=>{clearInterval(this.timer),this.shiDu="获取失败",this.shuiCao="获取失败",this.time="获取失败",this.yanWu="获取失败",this.fengShan="获取失败",uni.showModal({title:"获取失败"+e,confirmText:"重试",success:e=>{e.confirm&&(this.timer=setInterval((()=>this.huoQu()),6e4))}})},complete:()=>{uni.hideLoading()}})},faSong(){uni.request({url:"https://iot_s1.dfrobot.com.cn/apiv2/publish?topic=bGJkTK1nR&msg="+this.content+"&token=711b0145cf743d16e4b30dcdaf9ab4e2&iname=wBE94qNnR&ipwd=wfE9VqHngz&timemark=1665110169024",method:"GET",dataType:"json",complete:e=>{(e.message="Success")?(uni.showToast({icon:"success",title:"发送成功！！！"}),this.content=""):(uni.showToast({icon:"fail",title:"发送失败！！！"}),this.content="")}})},push(e,t){uni.createPushMessage({title:e,content:t})}}},[["render",function(t,i,n,a,s,o){return e.openBlock(),e.createElementBlock("view",{class:"content"},[e.createElementVNode("view",{class:e.normalizeClass(s.shiDuOK)},[e.createElementVNode("text",{class:"biaoTi"},"土壤湿度："),e.createElementVNode("text",{class:"jieGuo"},e.toDisplayString(s.shiDu),1)],2),e.createElementVNode("view",{class:e.normalizeClass(s.shuiCaoOK)},[e.createElementVNode("text",{class:"biaoTi"},"水槽水量情况："),e.createElementVNode("text",{class:"jieGuo"},e.toDisplayString(s.shuiCao),1)],2),e.createElementVNode("view",{class:e.normalizeClass(s.yanWuOK)},[e.createElementVNode("text",{class:"biaoTi"},"烟雾浓度："),e.createElementVNode("text",{class:"jieGuo"},e.toDisplayString(s.yanWu),1)],2),e.createElementVNode("view",{class:e.normalizeClass(s.fengShanOK)},[e.createElementVNode("text",{class:"biaoTi"},"小风扇状态："),e.createElementVNode("text",{class:"jieGuo"},e.toDisplayString(s.fengShan),1)],2),e.createElementVNode("view",{class:"hao"},[e.createElementVNode("text",{class:"biaoTi"},"最后更新时间："),e.createElementVNode("text",{class:"jieGuo"},e.toDisplayString(s.time),1)]),e.createElementVNode("text",{class:"shuoMing"},"（每分钟更新一次）"),e.createElementVNode("view",{class:"hao"},[e.createElementVNode("text",{class:"biaoTi"},"阈值管理"),e.createElementVNode("view",{class:"shuRu jieGuo"},[e.withDirectives(e.createElementVNode("input",{type:"text",placeholder:"输入阈值","onUpdate:modelValue":i[0]||(i[0]=e=>s.content=e)},null,512),[[e.vModelText,s.content]]),e.createElementVNode("button",{size:"mini",onClick:i[1]||(i[1]=e=>o.faSong()),type:"primary"},"发送")])])])}]]));const i={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:n,Vuex:a,Pinia:s}={app:e.createVueApp(i)};uni.Vuex=a,uni.Pinia=s,n.provide("__globalStyles",__uniConfig.styles),n._component.mpType="app",n._component.render=()=>{},n.mount("#app")}(Vue);
